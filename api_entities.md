Список полей для витрины cdm.dm_courier_ledger

    id — идентификатор записи.
    courier_id — ID курьера, которому перечисляем.
    courier_name — Ф. И. О. курьера.
    settlement_year — год отчёта.
    settlement_month — месяц отчёта, где 1 — январь и 12 — декабрь.
    orders_count — количество заказов за период (месяц).
    orders_total_sum — общая стоимость заказов.
    rate_avg — средний рейтинг курьера по оценкам пользователей.
    order_processing_fee — сумма, удержанная компанией за обработку заказов, которая высчитывается как orders_total_sum * 0.25.
    courier_order_sum — сумма, которую необходимо перечислить курьеру за доставленные им/ей заказы. За каждый доставленный заказ курьер должен получить некоторую сумму в зависимости от рейтинга (см. ниже).
    courier_tips_sum — сумма, которую пользователи оставили курьеру в качестве чаевых.
    courier_reward_sum — сумма, которую необходимо перечислить курьеру. Вычисляется как courier_order_sum + courier_tips_sum * 0.95 (5% — комиссия за обработку платежа).

Правила расчёта процента выплаты курьеру в зависимости от рейтинга, где r — это средний рейтинг курьера в расчётном месяце:

    r < 4 — 5% от заказа, но не менее 100 р.;
    4 <= r < 4.5 — 7% от заказа, но не менее 150 р.;
    4.5 <= r < 4.9 — 8% от заказа, но не менее 175 р.;
    4.9 <= r — 10% от заказа, но не менее 200 р.

Список таблиц в слое DDS:
Уже есть в хранилище:
dds.dm_orders - для связи заказа со временем
dds.dm_timestamps для определения года и месяца заказа

Необходимо создать:
dds.dm_couriers - справочник курьеров
dds.fcr_deliveries - таблица фактов доставок.

Сущности и поля для загрузки из API

1. Сущность Couriers (метод get /couriers)
   1. _id
   2. name

2. Сущность Deliveries (метод get /deliveries)
   1. order_id
   2. delivery_id
   3. courier_id
   4. order_ts
   5. delivery_ts
   6. rate
   7. sum
   8. tip_sum